---
  name: ARO HCP Infrastructure Deployment
  env:
    AZURE_CLIENT_ID: ${{ secrets.AZURE_CLIENT_ID }}
    AZURE_TENANT_ID: ${{ secrets.AZURE_TENANT_ID }}
    AZURE_SUBSCRIPTION_ID: ${{ secrets.AZURE_SUBSCRIPTION_ID }}
    PRINCIPAL_ID: ${{ secrets.GHA_PRINCIPAL_ID }}
  on:
    workflow_dispatch:
      inputs:
        deploy_env:
          description: 'Target environment'
          required: true
          type: choice
          options:
          - dev
          - cs-pr

  jobs:

    deploy_dev_environment_infra:
      name: 'Deploy ${{ inputs.deploy_env }} infrastructure'
      permissions:
        id-token: 'write'
        contents: 'read'
      secrets: inherit
      uses: ./.github/workflows/.env-infra-cd.yml
      with:
        deploy_env: ${{ inputs.deploy_env }}
        deploy_cs_pr_check_deps: ${{ inputs.deploy_env == 'cs-pr' }}

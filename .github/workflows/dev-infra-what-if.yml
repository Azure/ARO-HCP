---
  name: ARO HCP Integrated-DEV Infrastructure What-if
  env:
    AZURE_CLIENT_ID: ${{ secrets.AZURE_CLIENT_ID }}
    AZURE_TENANT_ID: ${{ secrets.AZURE_TENANT_ID }}
    AZURE_SUBSCRIPTION_ID: ${{ secrets.AZURE_SUBSCRIPTION_ID }}
    PRINCIPAL_ID: ${{ secrets.GHA_PRINCIPAL_ID }}
  on:
    pull_request:
      branches:
        - main
      paths:
        - 'config/public-cloud-dev.json'
        - 'dev-infrastructure/**'
        - '.github/workflows/.infra-what-if.yml'
        - '.github/workflows/dev-infra-what-if.yml'
        - 'templatize.sh'

  jobs:

    dev_what_if:
      name: 'DEV infrastructure what-if'
      permissions:
        id-token: 'write'
        contents: 'read'
      secrets: inherit
      uses: ./.github/workflows/.infra-what-if.yml
      with:
        deploy_env: dev

---
  name: ARO HCP CS-PR Infrastructure What-if
  env:
    AZURE_CLIENT_ID: ${{ secrets.AZURE_CLIENT_ID }}
    AZURE_TENANT_ID: ${{ secrets.AZURE_TENANT_ID }}
    AZURE_SUBSCRIPTION_ID: ${{ secrets.AZURE_SUBSCRIPTION_ID }}
    PRINCIPAL_ID: ${{ secrets.GHA_PRINCIPAL_ID }}
  on:
    pull_request:
      branches:
        - main
      paths:
        - 'config/public-cloud-cs-pr.json'
        - 'dev-infrastructure/**'
        - '.github/workflows/tmpl-infra-what-if.yml'
        - '.github/workflows/cs-pr-infra-what-if.yml'
        - 'templatize.sh'

  jobs:

    cs_pr_what_if:
      name: 'CS PR infrastructure what-if'
      permissions:
        id-token: 'write'
        contents: 'read'
      secrets: inherit
      uses: ./.github/workflows/tmpl-infra-what-if.yml
      with:
        deploy_env: cs-pr

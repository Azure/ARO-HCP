---
# Source: multicluster-engine-local-cluster/charts/policy/crds/agent.open-cluster-management.io_klusterletaddonconfigs_crd.yaml
# Copyright (c) 2020 Red Hat, Inc.
# Copyright Contributors to the Open Cluster Management project
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.5.0
  creationTimestamp: null
  name: klusterletaddonconfigs.agent.open-cluster-management.io
spec:
  group: agent.open-cluster-management.io
  names:
    kind: KlusterletAddonConfig
    listKind: KlusterletAddonConfigList
    plural: klusterletaddonconfigs
    singular: klusterletaddonconfig
  scope: Namespaced
  versions:
  - name: v1
    schema:
      openAPIV3Schema:
        description: KlusterletAddonConfig is the Schema for the klusterletaddonconfigs API
        properties:
          apiVersion:
            description: 'APIVersion defines the versioned schema of this representation of an object. Servers should convert recognized schemas to the latest internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
            type: string
          kind:
            description: 'Kind is a string value representing the REST resource this object represents. Servers may infer this from the endpoint the client submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
            type: string
          metadata:
            type: object
          spec:
            description: KlusterletAddonConfigSpec defines the desired state of KlusterletAddonConfig
            properties:
              applicationManager:
                description: ApplicationManagerConfig defines the configurations of ApplicationManager addon agent.
                properties:
                  enabled:
                    description: Enabled is the flag to enable/disable the addon. default is false.
                    type: boolean
                  proxyPolicy:
                    description: ProxyPolicy defines the policy to set proxy for each addon agent. default is Disabled. Disabled means that the addon agent pods do not configure the proxy env variables. OCPGlobalProxy means that the addon agent pods use the cluster-wide proxy config of OCP cluster provisioned by ACM. CustomProxy means that the addon agent pods use the ProxyConfig specified in KlusterletAddonConfig.
                    enum:
                    - Disabled
                    - OCPGlobalProxy
                    - CustomProxy
                    type: string
                type: object
              certPolicyController:
                description: CertPolicyControllerConfig defines the configurations of CertPolicyController addon agent.
                properties:
                  enabled:
                    description: Enabled is the flag to enable/disable the addon. default is false.
                    type: boolean
                  proxyPolicy:
                    description: ProxyPolicy defines the policy to set proxy for each addon agent. default is Disabled. Disabled means that the addon agent pods do not configure the proxy env variables. OCPGlobalProxy means that the addon agent pods use the cluster-wide proxy config of OCP cluster provisioned by ACM. CustomProxy means that the addon agent pods use the ProxyConfig specified in KlusterletAddonConfig.
                    enum:
                    - Disabled
                    - OCPGlobalProxy
                    - CustomProxy
                    type: string
                type: object
              clusterLabels:
                additionalProperties:
                  type: string
                description: DEPRECATED in release 2.4 and will be removed in the future since not used anymore.
                type: object
              clusterName:
                description: DEPRECATED in release 2.4 and will be removed in the future since not used anymore.
                minLength: 1
                type: string
              clusterNamespace:
                description: DEPRECATED in release 2.4 and will be removed in the future since not used anymore.
                minLength: 1
                type: string
              iamPolicyController:
                description: DEPRECATED in release 2.11 and will be removed in the future since not used anymore.
                properties:
                  enabled:
                    description: Enabled is the flag to enable/disable the addon. default is false.
                    type: boolean
                  proxyPolicy:
                    description: |-
                      ProxyPolicy defines the policy to set proxy for each addon agent. default is Disabled.
                      Disabled means that the addon agent pods do not configure the proxy env variables.
                      OCPGlobalProxy means that the addon agent pods use the cluster-wide proxy config of OCP cluster provisioned by ACM.
                      CustomProxy means that the addon agent pods use the ProxyConfig specified in KlusterletAddonConfig.
                    enum:
                    - Disabled
                    - OCPGlobalProxy
                    - CustomProxy
                    type: string
                type: object
              policyController:
                description: PolicyController defines the configurations of PolicyController addon agent.
                properties:
                  enabled:
                    description: Enabled is the flag to enable/disable the addon. default is false.
                    type: boolean
                  proxyPolicy:
                    description: ProxyPolicy defines the policy to set proxy for each addon agent. default is Disabled. Disabled means that the addon agent pods do not configure the proxy env variables. OCPGlobalProxy means that the addon agent pods use the cluster-wide proxy config of OCP cluster provisioned by ACM. CustomProxy means that the addon agent pods use the ProxyConfig specified in KlusterletAddonConfig.
                    enum:
                    - Disabled
                    - OCPGlobalProxy
                    - CustomProxy
                    type: string
                type: object
              proxyConfig:
                description: ProxyConfig defines the cluster-wide proxy configuration of the OCP managed cluster.
                properties:
                  httpProxy:
                    description: HTTPProxy is the URL of the proxy for HTTP requests.  Empty means unset and will not result in an env var.
                    type: string
                  httpsProxy:
                    description: HTTPSProxy is the URL of the proxy for HTTPS requests.  Empty means unset and will not result in an env var.
                    type: string
                  noProxy:
                    description: NoProxy is a comma-separated list of hostnames and/or CIDRs for which the proxy should not be used. Empty means unset and will not result in an env var. The API Server of Hub cluster should be added here. And If you scale up workers that are not included in the network defined by the networking.machineNetwork[].cidr field from the installation configuration, you must add them to this list to prevent connection issues.
                    type: string
                type: object
              searchCollector:
                description: SearchCollectorConfig defines the configurations of SearchCollector addon agent.
                properties:
                  enabled:
                    description: Enabled is the flag to enable/disable the addon. default is false.
                    type: boolean
                  proxyPolicy:
                    description: ProxyPolicy defines the policy to set proxy for each addon agent. default is Disabled. Disabled means that the addon agent pods do not configure the proxy env variables. OCPGlobalProxy means that the addon agent pods use the cluster-wide proxy config of OCP cluster provisioned by ACM. CustomProxy means that the addon agent pods use the ProxyConfig specified in KlusterletAddonConfig.
                    enum:
                    - Disabled
                    - OCPGlobalProxy
                    - CustomProxy
                    type: string
                type: object
              version:
                description: DEPRECATED in release 2.4 and will be removed in the future since not used anymore.
                type: string
            required:
            - applicationManager
            - certPolicyController
            - policyController
            - searchCollector
            type: object
          status:
            description: KlusterletAddonConfigStatus defines the observed state of KlusterletAddonConfig
            properties:
              conditions:
                description: Conditions contains condition information for the klusterletAddonConfig
                items:
                  description: "Condition contains details for one aspect of the current state of this API Resource. --- This struct is intended for direct use as an array at the field path .status.conditions.  For example, type FooStatus struct{     // Represents the observations of a foo's current state.     // Known .status.conditions.type are: \"Available\", \"Progressing\", and \"Degraded\"     // +patchMergeKey=type     // +patchStrategy=merge     // +listType=map     // +listMapKey=type     Conditions []metav1.Condition `json:\"conditions,omitempty\" patchStrategy:\"merge\" patchMergeKey:\"type\" protobuf:\"bytes,1,rep,name=conditions\"` \n     // other fields }"
                  properties:
                    lastTransitionTime:
                      description: lastTransitionTime is the last time the condition transitioned from one status to another. This should be when the underlying condition changed.  If that is not known, then using the time when the API field changed is acceptable.
                      format: date-time
                      type: string
                    message:
                      description: message is a human readable message indicating details about the transition. This may be an empty string.
                      maxLength: 32768
                      type: string
                    observedGeneration:
                      description: observedGeneration represents the .metadata.generation that the condition was set based upon. For instance, if .metadata.generation is currently 12, but the .status.conditions[x].observedGeneration is 9, the condition is out of date with respect to the current state of the instance.
                      format: int64
                      minimum: 0
                      type: integer
                    reason:
                      description: reason contains a programmatic identifier indicating the reason for the condition's last transition. Producers of specific condition types may define expected values and meanings for this field, and whether the values are considered a guaranteed API. The value should be a CamelCase string. This field may not be empty.
                      maxLength: 1024
                      minLength: 1
                      pattern: ^[A-Za-z]([A-Za-z0-9_,:]*[A-Za-z0-9_])?$
                      type: string
                    status:
                      description: status of the condition, one of True, False, Unknown.
                      enum:
                      - "True"
                      - "False"
                      - Unknown
                      type: string
                    type:
                      description: type of condition in CamelCase or in foo.example.com/CamelCase. --- Many .condition.type values are consistent across resources like Available, but because arbitrary conditions can be useful (see .node.status.conditions), the ability to deconflict is important. The regex it matches is (dns1123SubdomainFmt/)?(qualifiedNameFmt)
                      maxLength: 316
                      pattern: ^([a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*/)?(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])$
                      type: string
                  required:
                  - lastTransitionTime
                  - message
                  - reason
                  - status
                  - type
                  type: object
                type: array
              ocpGlobalProxy:
                description: OCPGlobalProxy is the cluster-wide proxy config of the OCP cluster provisioned by ACM
                properties:
                  httpProxy:
                    description: HTTPProxy is the URL of the proxy for HTTP requests.  Empty means unset and will not result in an env var.
                    type: string
                  httpsProxy:
                    description: HTTPSProxy is the URL of the proxy for HTTPS requests.  Empty means unset and will not result in an env var.
                    type: string
                  noProxy:
                    description: NoProxy is a comma-separated list of hostnames and/or CIDRs for which the proxy should not be used. Empty means unset and will not result in an env var. The API Server of Hub cluster should be added here. And If you scale up workers that are not included in the network defined by the networking.machineNetwork[].cidr field from the installation configuration, you must add them to this list to prevent connection issues.
                    type: string
                type: object
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
status:
  acceptedNames:
    kind: ""
    plural: ""
  conditions: []
  storedVersions: []

---
# Source: multicluster-engine-local-cluster/charts/policy/crds/apps.open-cluster-management.io_placementrules_crd_v1.yaml
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: placementrules.apps.open-cluster-management.io
spec:
  group: apps.open-cluster-management.io
  names:
    kind: PlacementRule
    listKind: PlacementRuleList
    plural: placementrules
    singular: placementrule
  scope: Namespaced
  versions:
  - additionalPrinterColumns:
    - jsonPath: .metadata.creationTimestamp
      name: Age
      type: date
    - jsonPath: .spec.clusterReplicas
      name: Replicas
      type: integer
    name: v1
    schema:
      openAPIV3Schema:
        description: PlacementRule is the Schema for the placementrules API
        properties:
          apiVersion:
            description: 'APIVersion defines the versioned schema of this representation of an object. Servers should convert recognized schemas to the latest internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
            type: string
          kind:
            description: 'Kind is a string value representing the REST resource this object represents. Servers may infer this from the endpoint the client submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
            type: string
          metadata:
            type: object
          spec:
            description: PlacementRuleSpec defines the desired state of PlacementRule
            properties:
              clusterConditions:
                items:
                  description: ClusterConditionFilter defines filter to filter cluster condition
                  properties:
                    status:
                      type: string
                    type:
                      type: string
                  type: object
                type: array
              clusterReplicas:
                description: number of replicas Application wants to
                format: int32
                type: integer
              clusterSelector:
                description: A label selector is a label query over a set of resources. The result of matchLabels and matchExpressions are ANDed. An empty label selector matches all objects. A null label selector matches no objects.
                properties:
                  matchExpressions:
                    description: matchExpressions is a list of label selector requirements. The requirements are ANDed.
                    items:
                      description: A label selector requirement is a selector that contains values, a key, and an operator that relates the key and values.
                      properties:
                        key:
                          description: key is the label key that the selector applies to.
                          type: string
                        operator:
                          description: operator represents a key's relationship to a set of values. Valid operators are In, NotIn, Exists and DoesNotExist.
                          type: string
                        values:
                          description: values is an array of string values. If the operator is In or NotIn, the values array must be non-empty. If the operator is Exists or DoesNotExist, the values array must be empty. This array is replaced during a strategic merge patch.
                          items:
                            type: string
                          type: array
                      required:
                      - key
                      - operator
                      type: object
                    type: array
                  matchLabels:
                    additionalProperties:
                      type: string
                    description: matchLabels is a map of {key,value} pairs. A single {key,value} in the matchLabels map is equivalent to an element of matchExpressions, whose key field is "key", the operator is "In", and the values array contains only "value". The requirements are ANDed.
                    type: object
                type: object
              clusters:
                items:
                  description: GenericClusterReference - in alignment with kubefed
                  properties:
                    name:
                      type: string
                  required:
                  - name
                  type: object
                type: array
              policies:
                description: Set Policy Filters
                items:
                  description: 'ObjectReference contains enough information to let you inspect or modify the referred object. --- New uses of this type are discouraged because of difficulty describing its usage when embedded in APIs.  1. Ignored fields.  It includes many fields which are not generally honored.  For instance, ResourceVersion and FieldPath are both very rarely valid in actual usage.  2. Invalid usage help.  It is impossible to add specific help for individual usage.  In most embedded usages, there are particular     restrictions like, "must refer only to types A and B" or "UID not honored" or "name must be restricted".     Those cannot be well described when embedded.  3. Inconsistent validation.  Because the usages are different, the validation rules are different by usage, which makes it hard for users to predict what will happen.  4. The fields are both imprecise and overly precise.  Kind is not a precise mapping to a URL. This can produce ambiguity     during interpretation and require a REST mapping.  In most cases, the dependency is on the group,resource tuple     and the version of the actual struct is irrelevant.  5. We cannot easily change it.  Because this type is embedded in many locations, updates to this type     will affect numerous schemas.  Don''t make new APIs embed an underspecified API type they do not control. Instead of using this type, create a locally provided and used type that is well-focused on your reference. For example, ServiceReferences for admission registration: https://github.com/kubernetes/api/blob/release-1.17/admissionregistration/v1/types.go#L533 .'
                  properties:
                    apiVersion:
                      description: API version of the referent.
                      type: string
                    fieldPath:
                      description: 'If referring to a piece of an object instead of an entire object, this string should contain a valid JSON/Go field access statement, such as desiredState.manifest.containers[2]. For example, if the object reference is to a container within a pod, this would take on a value like: "spec.containers{name}" (where "name" refers to the name of the container that triggered the event) or if no container name is specified "spec.containers[2]" (container with index 2 in this pod). This syntax is chosen only to have some well-defined way of referencing a part of an object. TODO: this design is not final and this field is subject to change in the future.'
                      type: string
                    kind:
                      description: 'Kind of the referent. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
                      type: string
                    name:
                      description: 'Name of the referent. More info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names'
                      type: string
                    namespace:
                      description: 'Namespace of the referent. More info: https://kubernetes.io/docs/concepts/overview/working-with-objects/namespaces/'
                      type: string
                    resourceVersion:
                      description: 'Specific resourceVersion to which this reference is made, if any. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#concurrency-control-and-consistency'
                      type: string
                    uid:
                      description: 'UID of the referent. More info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#uids'
                      type: string
                  type: object
                type: array
              resourceHint:
                description: Select Resource
                properties:
                  order:
                    description: SelectionOrder is the type for Nodes
                    type: string
                  type:
                    description: ResourceType defines types can be sorted
                    type: string
                type: object
              schedulerName:
                description: 'INSERT ADDITIONAL SPEC FIELDS - desired state of cluster Important: Run "make" to regenerate code after modifying this file schedulerName, default to use mcm controller'
                type: string
            type: object
          status:
            description: PlacementRuleStatus defines the observed state of PlacementRule
            properties:
              decisions:
                description: 'INSERT ADDITIONAL STATUS FIELD - define observed state of cluster Important: Run "make" to regenerate code after modifying this file'
                items:
                  description: PlacementDecision defines the decision made by controller
                  properties:
                    clusterName:
                      type: string
                    clusterNamespace:
                      type: string
                  type: object
                type: array
            type: object
        required:
        - spec
        type: object
    served: true
    storage: true
    subresources:
      status: {}

---
# Source: multicluster-engine-local-cluster/charts/policy/crds/policy.open-cluster-management.io_placementbindings.yaml
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.16.3
  name: placementbindings.policy.open-cluster-management.io
spec:
  group: policy.open-cluster-management.io
  names:
    kind: PlacementBinding
    listKind: PlacementBindingList
    plural: placementbindings
    shortNames:
    - pb
    singular: placementbinding
  scope: Namespaced
  versions:
  - name: v1
    schema:
      openAPIV3Schema:
        description: >-
          PlacementBinding is the schema for the placementbindings API. A PlacementBinding resource binds a managed cluster placement resource to a policy or policy set, along with configurable overrides.
        properties:
          apiVersion:
            description: >-
              APIVersion defines the versioned schema of this representation of an object. Servers should convert recognized schemas to the latest internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          bindingOverrides:
            description: BindingOverrides defines the overrides for the subjects.
            properties:
              remediationAction:
                description: >-
                  RemediationAction overrides the policy remediationAction on target clusters. This parameter is optional. If you set it, you must set it to "enforce".
                enum:
                - Enforce
                - enforce
                type: string
            type: object
          kind:
            description: >-
              Kind is a string value representing the REST resource this object represents. Servers may infer this from the endpoint the client submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          placementRef:
            description: >-
              PlacementSubject defines the placement resource that is being bound to the subjects defined in the placement binding.
            properties:
              apiGroup:
                description: >-
                  APIGroup is the API group to which the kind belongs. Must be set to "cluster.open-cluster-management.io" for Placement or "apps.open-cluster-management.io" for PlacementRule (deprecated).
                enum:
                - apps.open-cluster-management.io
                - cluster.open-cluster-management.io
                minLength: 1
                type: string
              kind:
                description: >-
                  Kind is the kind of the placement resource. Must be set to either "Placement" or "PlacementRule" (deprecated).
                enum:
                - PlacementRule
                - Placement
                minLength: 1
                type: string
              name:
                description: Name is the name of the placement resource being bound.
                minLength: 1
                type: string
            required:
            - apiGroup
            - kind
            - name
            type: object
          status:
            description: PlacementBindingStatus defines the observed state of the PlacementBinding resource.
            type: object
          subFilter:
            description: >-
              SubFilter provides the ability to apply overrides to a subset of bound clusters when multiple placement bindings are used to bind a policy to placements. When set, only the overrides will be applied to the clusters bound by this placement binding but it will not be considered for placing the policy. This parameter is optional. If you set it, you must set it to "restricted".
            enum:
            - restricted
            type: string
          subjects:
            items:
              description: Subject defines the resource to bind to the placement resource.
              properties:
                apiGroup:
                  description: >-
                    APIGroup is the API group to which the kind belongs. Must be set to "policy.open-cluster-management.io".
                  enum:
                  - policy.open-cluster-management.io
                  minLength: 1
                  type: string
                kind:
                  description: >-
                    Kind is the kind of the object to bind to the placement resource. Must be set to either "Policy" or "PolicySet".
                  enum:
                  - Policy
                  - PolicySet
                  minLength: 1
                  type: string
                name:
                  description: Name is the name of the policy or policy set to bind to the placement resource.
                  minLength: 1
                  type: string
              required:
              - apiGroup
              - kind
              - name
              type: object
            minItems: 1
            type: array
        required:
        - placementRef
        - subjects
        type: object
    served: true
    storage: true
    subresources:
      status: {}

---
# Source: multicluster-engine-local-cluster/charts/policy/crds/policy.open-cluster-management.io_policies.yaml
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.16.3
  name: policies.policy.open-cluster-management.io
spec:
  group: policy.open-cluster-management.io
  names:
    kind: Policy
    listKind: PolicyList
    plural: policies
    shortNames:
    - plc
    singular: policy
  scope: Namespaced
  versions:
  - additionalPrinterColumns:
    - jsonPath: .spec.remediationAction
      name: Remediation action
      type: string
    - jsonPath: .status.compliant
      name: Compliance state
      type: string
    - jsonPath: .metadata.creationTimestamp
      name: Age
      type: date
    name: v1
    schema:
      openAPIV3Schema:
        description: >-
          Policy is the schema for the policies API. Policy wraps other policy engine resources in its "policy-templates" array in order to deliver the resources to managed clusters.
        properties:
          apiVersion:
            description: >-
              APIVersion defines the versioned schema of this representation of an object. Servers should convert recognized schemas to the latest internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: >-
              Kind is a string value representing the REST resource this object represents. Servers may infer this from the endpoint the client submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: >-
              PolicySpec defines the configurations of the policy engine resources to deliver to the managed clusters.
            properties:
              copyPolicyMetadata:
                description: >-
                  CopyPolicyMetadata specifies whether the labels and annotations of a policy should be copied when replicating the policy to a managed cluster. If set to "true", all of the labels and annotations of the policy are copied to the replicated policy. If set to "false", only the policy framework-specific policy labels and annotations are copied to the replicated policy. This setting is useful if there is tracking for metadata that should only exist on the root policy. It is recommended to set this to "false" when using Argo CD to deploy the policy definition since Argo CD uses metadata for tracking that should not be replicated. The default value is "true".
                type: boolean
              dependencies:
                description: >-
                  PolicyDependencies is a list of dependency objects detailed with extra considerations for compliance that should be fulfilled before applying the policies to the managed clusters.
                items:
                  description: >-
                    Each PolicyDependency defines an object reference which must be in a certain compliance state before the policy should be created.
                  oneOf:
                  - properties:
                      kind:
                        enum:
                        - CertificatePolicy
                        - ConfigurationPolicy
                      namespace:
                        maxLength: 0
                  - not:
                      properties:
                        kind:
                          pattern: ^(?:(?:Certificate|Configuration)Policy)$
                  properties:
                    apiVersion:
                      description: >-
                        APIVersion defines the versioned schema of this representation of an object. Servers should convert recognized schemas to the latest internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
                      type: string
                    compliance:
                      description: >-
                        Compliance is the required ComplianceState of the object that the policy depends on, at the following path, .status.compliant.
                      enum:
                      - Compliant
                      - Pending
                      - NonCompliant
                      type: string
                    kind:
                      description: >-
                        Kind is a string value representing the REST resource this object represents. Servers may infer this from the endpoint the client submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
                      type: string
                    name:
                      description: Name is the name of the object that the policy depends on.
                      type: string
                    namespace:
                      description: Namespace is the namespace of the object that the policy depends on (optional).
                      type: string
                  required:
                  - compliance
                  - name
                  type: object
                type: array
              disabled:
                description: >-
                  Disabled is a boolean parameter you can use to enable and disable the policy. When disabled, the policy is removed from managed clusters.
                type: boolean
              hubTemplateOptions:
                description: HubTemplateOptions changes the default behavior of hub templates.
                properties:
                  serviceAccountName:
                    description: >-
                      ServiceAccountName is the name of a service account in the same namespace as the policy to use for all hub template lookups. The service account must have list and watch permissions on any object the hub templates look up. If not specified, lookups are restricted to namespaced objects in the same namespace as the policy and to the `ManagedCluster` object associated with the propagated policy.
                    type: string
                type: object
              policy-templates:
                description: >-
                  PolicyTemplates is a list of definitions of policy engine resources to apply to managed clusters along with configurations on how it should be applied.
                items:
                  description: >-
                    PolicyTemplate is the definition of the policy engine resource to apply to the managed cluster, along with configurations on how it should be applied.
                  properties:
                    extraDependencies:
                      description: >-
                        ExtraDependencies is additional PolicyDependencies that only apply to this policy template. ExtraDependencies is a list of dependency objects detailed with extra considerations for compliance that should be fulfilled before applying the policy template to the managed clusters.
                      items:
                        description: >-
                          Each PolicyDependency defines an object reference which must be in a certain compliance state before the policy should be created.
                        oneOf:
                        - properties:
                            kind:
                              enum:
                              - CertificatePolicy
                              - ConfigurationPolicy
                            namespace:
                              maxLength: 0
                        - not:
                            properties:
                              kind:
                                pattern: ^(?:(?:Certificate|Configuration)Policy)$
                        properties:
                          apiVersion:
                            description: >-
                              APIVersion defines the versioned schema of this representation of an object. Servers should convert recognized schemas to the latest internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
                            type: string
                          compliance:
                            description: >-
                              Compliance is the required ComplianceState of the object that the policy depends on, at the following path, .status.compliant.
                            enum:
                            - Compliant
                            - Pending
                            - NonCompliant
                            type: string
                          kind:
                            description: >-
                              Kind is a string value representing the REST resource this object represents. Servers may infer this from the endpoint the client submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
                            type: string
                          name:
                            description: Name is the name of the object that the policy depends on.
                            type: string
                          namespace:
                            description: Namespace is the namespace of the object that the policy depends on (optional).
                            type: string
                        required:
                        - compliance
                        - name
                        type: object
                      type: array
                    ignorePending:
                      description: >-
                        IgnorePending is a boolean parameter to specify whether to ignore the "Pending" status of this template when calculating the overall policy status. The default value is "false" to not ignore a "Pending" status.
                      type: boolean
                    objectDefinition:
                      description: A Kubernetes object defining the policy to apply to a managed cluster
                      type: object
                      x-kubernetes-preserve-unknown-fields: true
                  required:
                  - objectDefinition
                  type: object
                type: array
              remediationAction:
                description: >-
                  RemediationAction specifies the remediation of the policy. The parameter values are "enforce" and "inform". If specified, the value that is defined overrides any remediationAction parameter defined in the child policies in the "policy-templates" section. Important: Not all policy engine kinds support the enforce feature.
                enum:
                - Inform
                - inform
                - Enforce
                - enforce
                type: string
            required:
            - disabled
            - policy-templates
            type: object
          status:
            description: PolicyStatus reports the observed status of the policy resulting from its policy templates.
            properties:
              compliant:
                description: >-
                  ComplianceState reports the observed status resulting from the definitions of this policy. This status field is only used in the replicated policy in the managed cluster namespace.
                enum:
                - Compliant
                - Pending
                - NonCompliant
                type: string
              details:
                description: >-
                  Details is the list of compliance details for each policy template definition. This status field is only used in the replicated policy in the managed cluster namespace.
                items:
                  description: >-
                    DetailsPerTemplate reports the current compliance state and list of recent compliance messages for a given policy template.
                  properties:
                    compliant:
                      description: ComplianceState reports the observed status resulting from the definitions of the policy.
                      enum:
                      - Compliant
                      - Pending
                      - NonCompliant
                      type: string
                    history:
                      items:
                        description: ComplianceHistory reports a compliance message from a given time and event.
                        properties:
                          eventName:
                            description: EventName is the name of the event attached to the message.
                            type: string
                          lastTimestamp:
                            description: LastTimestamp is the timestamp of the event that reported the message.
                            format: date-time
                            type: string
                          message:
                            description: Message is the compliance message resulting from evaluating the policy resource.
                            type: string
                        type: object
                      type: array
                    templateMeta:
                      type: object
                      x-kubernetes-preserve-unknown-fields: true
                  type: object
                type: array
              placement:
                description: >-
                  Placement is a list of managed cluster placement resources bound to the policy. This status field is only used in the root policy on the hub cluster.
                items:
                  description: Placement reports how and what managed cluster placement resources are attached to the policy.
                  properties:
                    decisions:
                      description: Decisions is the list of managed clusters returned by the placement resource for this binding.
                      items:
                        description: PlacementDecision is the cluster name returned by the placement resource.
                        properties:
                          clusterName:
                            type: string
                          clusterNamespace:
                            type: string
                        type: object
                      type: array
                    placement:
                      description: >-
                        Placement is the name of the Placement resource, from the cluster.open-cluster-management.io API group, that is bound to the policy.
                      type: string
                    placementBinding:
                      description: >-
                        PlacementBinding is the name of the PlacementBinding resource, from the policies.open-cluster-management.io API group, that binds the placement resource to the policy.
                      type: string
                    placementRule:
                      description: >-
                        PlacementRule (deprecated) is the name of the PlacementRule resource, from the apps.open-cluster-management.io API group, that is bound to the policy.
                      type: string
                    policySet:
                      description: >-
                        PolicySet is the name of the policy set containing this policy and bound to the placement. If specified, then for this placement the policy is being propagated through this policy set rather than the policy being bound directly to a placement and propagated individually.
                      type: string
                  type: object
                type: array
              status:
                description: >-
                  Status is a list of managed clusters and the current compliance state of each one. This status field is only used in the root policy on the hub cluster.
                items:
                  description: >-
                    CompliancePerClusterStatus reports the name of a managed cluster and its compliance state for this policy.
                  properties:
                    clustername:
                      type: string
                    clusternamespace:
                      type: string
                    compliant:
                      description: ComplianceState reports the observed status resulting from the definitions of the policy.
                      enum:
                      - Compliant
                      - Pending
                      - NonCompliant
                      type: string
                  type: object
                type: array
            type: object
        required:
        - metadata
        - spec
        type: object
    served: true
    storage: true
    subresources:
      status: {}

---
# Source: multicluster-engine-local-cluster/charts/policy/crds/policy.open-cluster-management.io_policyautomations.yaml
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.16.3
  name: policyautomations.policy.open-cluster-management.io
spec:
  group: policy.open-cluster-management.io
  names:
    kind: PolicyAutomation
    listKind: PolicyAutomationList
    plural: policyautomations
    shortNames:
    - plca
    singular: policyautomation
  scope: Namespaced
  versions:
  - name: v1beta1
    schema:
      openAPIV3Schema:
        description: >-
          PolicyAutomation is the schema for the policyautomations API. PolicyAutomation configures creation of an AnsibleJob, from the tower.ansible.com API group, to initiate Ansible to run upon noncompliant events of the attached policy, or when you manually initiate the run with the "policy.open-cluster-management.io/rerun=true" annotation.
        properties:
          apiVersion:
            description: >-
              APIVersion defines the versioned schema of this representation of an object. Servers should convert recognized schemas to the latest internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: >-
              Kind is a string value representing the REST resource this object represents. Servers may infer this from the endpoint the client submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: PolicyAutomationSpec defines how and when automation is initiated for the referenced policy.
            properties:
              automationDef:
                description: AutomationDef defines the automation to invoke.
                properties:
                  extra_vars:
                    description: ExtraVars is passed to the Ansible job at execution time and is a known Ansible entity.
                    type: object
                    x-kubernetes-preserve-unknown-fields: true
                  jobTtl:
                    description: >-
                      JobTTL sets the time to live for the Kubernetes Job object after the Ansible job playbook run has finished.
                    type: integer
                  name:
                    description: Name of the Ansible Template to run in Ansible Automation Platform as a job.
                    minLength: 1
                    type: string
                  policyViolationsLimit:
                    description: >-
                      The maximum number of violating cluster contexts that are provided to the Ansible job as extra variables. When policyViolationsLimit is set to "0", it means no limit. The default value is "1000".
                    minimum: 0
                    type: integer
                  secret:
                    description: TowerSecret is the name of the secret that contains the Ansible Automation Platform credential.
                    minLength: 1
                    type: string
                  type:
                    description: Type of the automation to invoke
                    type: string
                required:
                - name
                - secret
                type: object
              delayAfterRunSeconds:
                description: >-
                  DelayAfterRunSeconds sets the minimum number of seconds before an automation can run again due to a new violation on the same managed cluster. This only applies to the EveryEvent mode. The default value is "0".
                minimum: 0
                type: integer
              eventHook:
                default: noncompliant
                description: >-
                  EventHook specifies the compliance state that initiates automation. This must be set to "noncompliant".
                enum:
                - noncompliant
                type: string
              mode:
                description: >-
                  Mode specifies how often automation is initiated. The supported values are "once", "everyEvent", and "disabled".
                enum:
                - once
                - everyEvent
                - disabled
                type: string
              policyRef:
                description: PolicyRef is the name of the policy that this automation resource is bound to.
                type: string
              rescanAfter:
                description: RescanAfter is reserved for future use and should not be set.
                type: string
            required:
            - automationDef
            - mode
            - policyRef
            type: object
          status:
            description: PolicyAutomationStatus defines the observed state of the PolicyAutomation resource.
            properties:
              clustersWithEvent:
                additionalProperties:
                  description: ClusterEvent shows the PolicyAutomation event on each target cluster.
                  properties:
                    automationStartTime:
                      description: AutomationStartTime is the policy automation start time for everyEvent mode.
                      type: string
                    eventTime:
                      description: EventTime is the last policy compliance transition event time.
                      type: string
                  required:
                  - automationStartTime
                  - eventTime
                  type: object
                description: Cluster name as the key of ClustersWithEvent
                type: object
            type: object
        required:
        - spec
        type: object
    served: true
    storage: true
    subresources:
      status: {}

---
# Source: multicluster-engine-local-cluster/charts/policy/crds/policy.open-cluster-management.io_policysets.yaml
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.16.3
  name: policysets.policy.open-cluster-management.io
spec:
  group: policy.open-cluster-management.io
  names:
    kind: PolicySet
    listKind: PolicySetList
    plural: policysets
    shortNames:
    - plcset
    singular: policyset
  scope: Namespaced
  versions:
  - additionalPrinterColumns:
    - jsonPath: .status.compliant
      name: Compliance state
      type: string
    - jsonPath: .metadata.creationTimestamp
      name: Age
      type: date
    name: v1beta1
    schema:
      openAPIV3Schema:
        description: >-
          PolicySet is the schema for the policysets API. A policy set is a logical grouping of policies from the same namespace. The policy set is bound to a placement resource and applies the placement to all policies within the set. The status reports the overall compliance of the set.
        properties:
          apiVersion:
            description: >-
              APIVersion defines the versioned schema of this representation of an object. Servers should convert recognized schemas to the latest internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: >-
              Kind is a string value representing the REST resource this object represents. Servers may infer this from the endpoint the client submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: PolicySetSpec defines the group of policies to be included in the policy set.
            properties:
              description:
                description: Description is the description of this policy set.
                type: string
              policies:
                description: Policies is a list of policy names that are contained within the policy set.
                items:
                  minLength: 1
                  type: string
                type: array
            required:
            - policies
            type: object
          status:
            description: PolicySetStatus reports the observed status of the policy set resulting from its policies.
            properties:
              compliant:
                description: Compliant reports the observed status resulting from the compliance of the policies within.
                enum:
                - Compliant
                - Pending
                - NonCompliant
                type: string
              placement:
                items:
                  description: >-
                    PolicySetStatusPlacement reports how and what managed cluster placement resources are attached to the policy set.
                  properties:
                    placement:
                      description: >-
                        Placement is the name of the Placement resource, from the cluster.open-cluster-management.io API group, that is bound to the policy.
                      type: string
                    placementBinding:
                      description: >-
                        PlacementBinding is the name of the PlacementBinding resource, from the policies.open-cluster-management.io API group, that binds the placement resource to the policy set.
                      type: string
                    placementRule:
                      description: >-
                        PlacementRule (deprecated) is the name of the PlacementRule resource, from the apps.open-cluster-management.io API group, that is bound to the policy.
                      type: string
                  type: object
                type: array
              statusMessage:
                description: StatusMessge reports the current state while determining the compliance of the policy set.
                type: string
            type: object
        required:
        - spec
        type: object
    served: true
    storage: true
    subresources:
      status: {}

---
# Source: multicluster-engine-local-cluster/charts/policy/charts/cluster-lifecycle/templates/klusterlet-addon-service_account.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: klusterlet-addon-controller-v2
  namespace: 'multicluster-engine'
  labels:
    app: klusterlet-addon-controller-v2
    component: klusterlet-addon-controller
    app.kubernetes.io/name: klusterlet-addon-controller
---
# Source: multicluster-engine-local-cluster/charts/policy/charts/grc/templates/grc-policy-addon-sa.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: grc-policy-addon-sa
  namespace: 'multicluster-engine'
  labels:
    app: grc
    component: "ocm-policy-addon-ctrl"
    app.kubernetes.io/instance: grc
    app.kubernetes.io/name: grc
---
# Source: multicluster-engine-local-cluster/charts/policy/charts/grc/templates/grc-sa.yaml
# Copyright (c) 2020 Red Hat, Inc.
apiVersion: v1
kind: ServiceAccount
metadata:
  name: grc-sa
  namespace: 'multicluster-engine'
  labels:
    app: grc
    component: "ocm-grc-sa"
---
# Source: multicluster-engine-local-cluster/charts/policy/charts/cluster-lifecycle/templates/klusterlet-addon-role.yaml
# Copyright Contributors to the Open Cluster Management project
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: open-cluster-management:klusterlet-addon-controller-v2
  labels:
    app: klusterlet-addon-controller-v2
    component: klusterlet-addon-controller
    app.kubernetes.io/name: klusterlet-addon-controller
rules:
- apiGroups:
  - ""
  resources:
  - events
  - secrets
  - configmaps
  - serviceaccounts
  - services
  verbs:
  - create
  - delete
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - agent.open-cluster-management.io
  resources:
  - klusterletaddonconfigs
  - klusterletaddonconfigs/finalizers
  - klusterletaddonconfigs/status
  verbs:
  - create
  - delete
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - cluster.open-cluster-management.io
  resources:
  - managedclusters
  - managedclusters/finalizers
  verbs:
  - create
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - work.open-cluster-management.io
  resources:
  - manifestworks
  - manifestworks/finalizers
  verbs:
  - create
  - delete
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - rbac.authorization.k8s.io
  resources:
  - roles
  - rolebindings
  verbs:
  - create
  - delete
  - get
  - list
  - patch
  - update
  - watch
# appmgr
- apiGroups:
  - apps.open-cluster-management.io
  resources:
  - subscriptions
  verbs:
  - get
  - list
  - watch
- apiGroups:
  - coordination.k8s.io
  resources:
  - leases
  verbs:
  - create
  - get
  - list
  - patch
  - update
  - watch
  - delete
- apiGroups:
  - addon.open-cluster-management.io
  resources:
  - managedclusteraddons
  - managedclusteraddons/status
  - clustermanagementaddons
  verbs:
  - create
  - delete
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - imageregistry.open-cluster-management.io
  resources:
  - managedclusterimageregistries
  - managedclusterimageregistries/status
  verbs:
  - get
  - list
  - watch
- apiGroups:
  - operator.open-cluster-management.io
  resources:
  - multiclusterhubs
  verbs:
  - get
  - list
---
# Source: multicluster-engine-local-cluster/charts/policy/charts/grc/templates/grc-clusterrole.yaml
# Copyright (c) 2020 Red Hat, Inc.
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: open-cluster-management:grc:clusterrole
  labels:
    app: grc
    component: "ocm-grc-clusterrole"
rules:
- apiGroups:
  - tower.ansible.com
  resources:
  - ansiblejobs
  verbs:
  - create
  - delete
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - ""
  resources:
  - events
  verbs:
  - create
  - delete
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - policy.open-cluster-management.io
  resources:
  - '*'
  verbs:
  - create
  - delete
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - apps.open-cluster-management.io
  resources:
  - placementrules
  verbs:
  - get
  - list
  - watch
- apiGroups:
  - cluster.open-cluster-management.io
  resources:
  - managedclusters
  - placementdecisions
  - placements
  verbs:
  - get
  - list
  - watch
- apiGroups:
  - 'authentication.k8s.io'
  resources:
  - 'tokenreviews'
  verbs:
  - create
- apiGroups:
  - authorization.k8s.io
  resources:
  - subjectaccessreviews
  verbs:
  - create
- apiGroups:
  - '*'
  resources:
  - '*'
  verbs:
  - get
  - list
  - watch
- apiGroups:
  - ""
  resources:
  - secrets
  verbs:
  - create
- apiGroups:
  - ""
  resourceNames:
  - policy-encryption-key
  resources:
  - secrets
  verbs:
  - delete
  - patch
  - update
  - watch
- apiGroups:
  - ""
  resources:
  - serviceaccounts/token
  verbs:
  - create
---
# Source: multicluster-engine-local-cluster/charts/policy/charts/grc/templates/grc-policy-addon-clusterrole.yaml
# Copyright (c) 2022 Red Hat, Inc.
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: open-cluster-management:grc:policyaddon-clusterrole
  labels:
    app: grc
    component: "ocm-policy-addon-ctrl"
rules:
- apiGroups:
  - addon.open-cluster-management.io
  resources:
  - addondeploymentconfigs
  verbs:
  - get
  - list
  - watch
- apiGroups:
  - addon.open-cluster-management.io
  resources:
  - clustermanagementaddons
  verbs:
  - get
  - list
  - watch
- apiGroups:
  - addon.open-cluster-management.io
  resourceNames:
  - cert-policy-controller
  - config-policy-controller
  - governance-policy-framework
  - governance-standalone-hub-templating
  resources:
  - clustermanagementaddons/finalizers
  verbs:
  - update
- apiGroups:
  - addon.open-cluster-management.io
  resourceNames:
  - cert-policy-controller
  - config-policy-controller
  - governance-policy-framework
  - governance-standalone-hub-templating
  resources:
  - clustermanagementaddons/status
  verbs:
  - patch
  - update
- apiGroups:
  - addon.open-cluster-management.io
  resources:
  - managedclusteraddons
  verbs:
  - create
  - get
  - list
  - update
  - watch
- apiGroups:
  - addon.open-cluster-management.io
  resourceNames:
  - cert-policy-controller
  - config-policy-controller
  - governance-policy-framework
  - governance-standalone-hub-templating
  resources:
  - managedclusteraddons
  verbs:
  - delete
- apiGroups:
  - addon.open-cluster-management.io
  resourceNames:
  - cert-policy-controller
  - config-policy-controller
  - governance-policy-framework
  - governance-standalone-hub-templating
  resources:
  - managedclusteraddons/finalizers
  verbs:
  - update
- apiGroups:
  - addon.open-cluster-management.io
  resourceNames:
  - cert-policy-controller
  - config-policy-controller
  - governance-policy-framework
  - governance-standalone-hub-templating
  resources:
  - managedclusteraddons/status
  verbs:
  - patch
  - update
- apiGroups:
  - authorization.k8s.io
  resources:
  - subjectaccessreviews
  verbs:
  - create
  - get
- apiGroups:
  - certificates.k8s.io
  resources:
  - certificatesigningrequests
  - certificatesigningrequests/approval
  verbs:
  - create
  - get
  - list
  - update
  - watch
- apiGroups:
  - certificates.k8s.io
  resources:
  - signers
  verbs:
  - approve
- apiGroups:
  - cluster.open-cluster-management.io
  resourceNames:
  - id.k8s.io
  resources:
  - clusterclaims
  verbs:
  - get
- apiGroups:
  - cluster.open-cluster-management.io
  resources:
  - managedclusters
  verbs:
  - get
  - list
  - watch
- apiGroups:
  - config.openshift.io
  resources:
  - infrastructures
  verbs:
  - get
  - list
  - watch
- apiGroups:
  - coordination.k8s.io
  resources:
  - leases
  verbs:
  - create
- apiGroups:
  - coordination.k8s.io
  resourceNames:
  - cert-policy-controller
  - config-policy-controller
  - governance-policy-framework
  - governance-standalone-hub-templating
  resources:
  - leases
  verbs:
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - ""
  resources:
  - events
  verbs:
  - create
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - ""
  resources:
  - pods
  verbs:
  - get
  - list
  - watch
- apiGroups:
  - ""
  resourceNames:
  - governance-policy-database
  - policy-encryption-key
  resources:
  - secrets
  verbs:
  - get
  - list
  - watch
- apiGroups:
  - operator.open-cluster-management.io
  resourceNames:
  - grc
  resources:
  - internalhubcomponents
  verbs:
  - get
  - list
  - update
  - watch
- apiGroups:
  - operator.open-cluster-management.io
  resourceNames:
  - grc
  resources:
  - internalhubcomponents/finalizers
  verbs:
  - update
- apiGroups:
  - policy.open-cluster-management.io
  resources:
  - policies
  verbs:
  - create
  - delete
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - policy.open-cluster-management.io
  resources:
  - policies/finalizers
  verbs:
  - update
- apiGroups:
  - policy.open-cluster-management.io
  resources:
  - policies/status
  verbs:
  - get
  - patch
  - update
- apiGroups:
  - rbac.authorization.k8s.io
  resources:
  - clusterroles
  - clusterrolebindings
  verbs:
  - create
- apiGroups:
  - rbac.authorization.k8s.io
  resourceNames:
  - open-cluster-management:cert-policy-controller-hub
  - open-cluster-management:config-policy-controller-hub
  - open-cluster-management:policy-framework-hub
  - open-cluster-management:governance-standalone-hub-templating
  resources:
  - clusterroles
  verbs:
  - delete
  - get
  - patch
  - update
- apiGroups:
  - rbac.authorization.k8s.io
  resourceNames:
  - open-cluster-management:governance-standalone-hub-templating
  resources:
  - clusterrolebindings
  verbs:
  - delete
  - get
  - patch
  - update
- apiGroups:
  - rbac.authorization.k8s.io
  resources:
  - rolebindings
  verbs:
  - create
- apiGroups:
  - rbac.authorization.k8s.io
  resourceNames:
  - open-cluster-management:cert-policy-controller-hub
  - open-cluster-management:config-policy-controller-hub
  - open-cluster-management:policy-framework-hub
  - open-cluster-management:governance-standalone-hub-templating
  resources:
  - rolebindings
  verbs:
  - delete
  - get
  - patch
  - update
- apiGroups:
  - route.openshift.io
  resources:
  - routes
  verbs:
  - create
- apiGroups:
  - route.openshift.io
  resourceNames:
  - governance-history-api
  resources:
  - routes
  verbs:
  - delete
  - get
  - list
  - update
  - watch
- apiGroups:
  - work.open-cluster-management.io
  resources:
  - manifestworks
  verbs:
  - create
  - delete
  - get
  - list
  - patch
  - update
  - watch
---
# Source: multicluster-engine-local-cluster/charts/policy/charts/cluster-lifecycle/templates/klusterlet-addon-role_binding.yaml
# Copyright Contributors to the Open Cluster Management project
kind: ClusterRoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: open-cluster-management:klusterlet-addon-controller-v2
  labels:
    app: klusterlet-addon-controller-v2
    component: klusterlet-addon-controller
    app.kubernetes.io/name: klusterlet-addon-controller
subjects:
- kind: ServiceAccount
  name: klusterlet-addon-controller-v2
  namespace: 'multicluster-engine'
roleRef:
  kind: ClusterRole
  name: open-cluster-management:klusterlet-addon-controller-v2
  apiGroup: rbac.authorization.k8s.io
---
# Source: multicluster-engine-local-cluster/charts/policy/charts/grc/templates/grc-clusterrolebinding.yaml
# Copyright (c) 2020 Red Hat, Inc.
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: open-cluster-management:grc:clusterrolebinding
  namespace: 'multicluster-engine'
  labels:
    app: grc
roleRef:
  kind: ClusterRole
  name: open-cluster-management:grc:clusterrole
  apiGroup: rbac.authorization.k8s.io
subjects:
- kind: ServiceAccount
  name: grc-sa
  namespace: 'multicluster-engine'
---
# Source: multicluster-engine-local-cluster/charts/policy/charts/grc/templates/grc-policy-addon-clusterrolebinding.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: open-cluster-management:grc:policyaddon-clusterrolebinding
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: open-cluster-management:grc:policyaddon-clusterrole
subjects:
- kind: ServiceAccount
  name: grc-policy-addon-sa
  namespace: 'multicluster-engine'
---
# Source: multicluster-engine-local-cluster/charts/policy/charts/grc/templates/grc-policy-addon-role.yaml
# Copyright (c) 2022 Red Hat, Inc.
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: grc-grc-policy-addon-role
  namespace: multicluster-engine
  labels:
    app: grc
    component: "ocm-policy-addon-ctrl"
rules:
- apiGroups:
  - ""
  resources:
  - configmaps
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
- apiGroups:
  - coordination.k8s.io
  resources:
  - leases
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
- apiGroups:
  - ""
  resources:
  - events
  verbs:
  - create
  - patch
---
# Source: multicluster-engine-local-cluster/charts/policy/charts/grc/templates/grc-role.yaml
# Copyright (c) 2020 Red Hat, Inc.
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: grc-grc-role
  namespace: multicluster-engine
  labels:
    app: grc
    component: "ocm-grc-role"
rules:
- apiGroups:
  - ""
  resources:
  - pods
  - services
  - services/finalizers
  - endpoints
  - persistentvolumeclaims
  - events
  - configmaps
  - secrets
  verbs:
  - create
  - delete
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - apps
  resources:
  - deployments
  - daemonsets
  - replicasets
  - statefulsets
  verbs:
  - create
  - delete
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - monitoring.coreos.com
  resources:
  - servicemonitors
  verbs:
  - get
  - create
- apiGroups:
  - apps.open-cluster-management.io
  resources:
  - '*'
  verbs:
  - update
- apiGroups:
  - operator.open-cluster-management.io
  resources:
  - multiclusterhubs
  verbs:
  - get
- apiGroups:
  - apps
  resourceNames:
  - grc-policy-propagator
  resources:
  - deployments/finalizers
  verbs:
  - update
- apiGroups:
  - ""
  resources:
  - pods
  verbs:
  - get
- apiGroups:
  - apps
  resources:
  - replicasets
  - deployments
  verbs:
  - get
- apiGroups:
  - coordination.k8s.io
  resources:
  - leases
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
- apiGroups:
  - policy.open-cluster-management.io
  resources:
  - policysets
  verbs:
  - create
  - delete
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - policy.open-cluster-management.io
  resources:
  - policysets/finalizers
  verbs:
  - update
- apiGroups:
  - policy.open-cluster-management.io
  resources:
  - policysets/status
  verbs:
  - get
  - patch
  - update
---
# Source: multicluster-engine-local-cluster/charts/policy/charts/grc/templates/grc-policy-addon-rolebinding.yaml
kind: RoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: grc-grc-policy-addon-rolebinding
  namespace: 'multicluster-engine'
  labels:
    app: grc
roleRef:
  kind: Role
  name: grc-grc-policy-addon-role
  apiGroup: rbac.authorization.k8s.io
subjects:
- kind: ServiceAccount
  name: grc-policy-addon-sa
---
# Source: multicluster-engine-local-cluster/charts/policy/charts/grc/templates/grc-rolebinding.yaml
# Copyright (c) 2020 Red Hat, Inc.
kind: RoleBinding
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: grc-grc-rolebinding
  namespace: 'multicluster-engine'
  labels:
    app: grc
    component: "ocm-grc-rolebinding"
roleRef:
  kind: Role
  name: grc-grc-role
  apiGroup: rbac.authorization.k8s.io
subjects:
- kind: ServiceAccount
  name: grc-sa
---
# Source: multicluster-engine-local-cluster/charts/policy/charts/cluster-lifecycle/templates/klusterlet-addon-deployment.yaml
# Copyright Contributors to the Open Cluster Management project

apiVersion: apps/v1
kind: Deployment
metadata:
  name: klusterlet-addon-controller-v2
  namespace: multicluster-engine
  labels:
    app: klusterlet-addon-controller-v2
    component: klusterlet-addon-controller
    app.kubernetes.io/name: klusterlet-addon-controller
spec:
  minReadySeconds: 0
  replicas: 2
  selector:
    matchLabels:
      app: klusterlet-addon-controller-v2
      component: klusterlet-addon-controller
  template:
    metadata:
      labels:
        app: klusterlet-addon-controller-v2
        ocm-antiaffinity-selector: "klusterletaddon"
        component: klusterlet-addon-controller
        app.kubernetes.io/name: klusterlet-addon-controller
    spec:
      imagePullSecrets:
        - name: open-cluster-management-image-pull-credentials
      serviceAccountName: klusterlet-addon-controller-v2
      hostNetwork: false
      hostPID: false
      hostIPC: false
      terminationGracePeriodSeconds: 60
      securityContext:
        runAsNonRoot: true
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: kubernetes.io/arch
                operator: In
                values:
                - amd64
                - ppc64le
                - s390x
                - arm64
        podAntiAffinity:
          preferredDuringSchedulingIgnoredDuringExecution:
          - weight: 70
            podAffinityTerm:
              topologyKey: topology.kubernetes.io/zone
              labelSelector:
                matchExpressions:
                - key: ocm-antiaffinity-selector
                  operator: In
                  values:
                  - klusterletaddon
          - weight: 35
            podAffinityTerm:
              topologyKey: kubernetes.io/hostname
              labelSelector:
                matchExpressions:
                - key: ocm-antiaffinity-selector
                  operator: In
                  values:
                  - klusterletaddon
      containers:
      - name: klusterlet-addon-controller
        image: "arohcpsvcdev.azurecr.io/acm-d-cache/klusterlet-addon-controller-rhel9@sha256:1234567890"
        imagePullPolicy: 
        securityContext:
          allowPrivilegeEscalation: false
          capabilities:
            drop:
            - ALL
          privileged: false
          readOnlyRootFilesystem: true
        resources:
          requests:
            memory: "96Mi"
            cpu: "50m"
        env:
          - name: WATCH_NAMESPACE
          - name: POD_NAME
            valueFrom:
              fieldRef:
                fieldPath: metadata.name
          - name: OPERATOR_NAME
            value: klusterlet-addon-controller
          - name: HUB_VERSION
            value: 
          - name: USE_SHA_MANIFEST
            value: "true"
          - name: DEFAULT_IMAGE_PULL_SECRET
            value: open-cluster-management-image-pull-credentials
          - name: DEFAULT_IMAGE_REGISTRY
            value: 
          - name: ADDON_CLUSTERROLE_PREFIX
            value: "open-cluster-management:addons:"
          - name: POD_NAMESPACE
            valueFrom:
              fieldRef:
                fieldPath: metadata.namespace
---
# Source: multicluster-engine-local-cluster/charts/policy/charts/grc/templates/grc-policy-addon-controller.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    app: grc
    component: ocm-policy-addon-ctrl
  name: grc-policy-addon-controller
  namespace: 'multicluster-engine'
spec:
  progressDeadlineSeconds: 600
  replicas: 2
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      app: grc
      component: ocm-policy-addon-ctrl
  strategy:
    rollingUpdate:
      maxSurge: 25%
      maxUnavailable: 25%
    type: RollingUpdate
  template:
    metadata:
      labels:
        app: grc
        component: ocm-policy-addon-ctrl
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: kubernetes.io/arch
                operator: In
                values:
                - amd64
                - ppc64le
                - s390x
                - arm64
        podAntiAffinity:
          preferredDuringSchedulingIgnoredDuringExecution:
          - podAffinityTerm:
              labelSelector:
                matchExpressions:
                - key: ocm-antiaffinity-selector
                  operator: In
                  values:
                  - grcpolicyaddon
              topologyKey: topology.kubernetes.io/zone
            weight: 70
          - podAffinityTerm:
              labelSelector:
                matchExpressions:
                - key: ocm-antiaffinity-selector
                  operator: In
                  values:
                  - grcpolicyaddon
              topologyKey: kubernetes.io/hostname
            weight: 35
      containers:
      - args:
        - controller
        command:
        - governance-policy-addon-controller
        env:
        - name: POD_NAME
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: metadata.name
        - name: CONFIG_POLICY_CONTROLLER_IMAGE
          value: "arohcpsvcdev.azurecr.io/acm-d-cache/config-policy-controller-rhel9@sha256:1234567890"
        - name: GOVERNANCE_POLICY_FRAMEWORK_ADDON_IMAGE
          value: "arohcpsvcdev.azurecr.io/acm-d-cache/acm-governance-policy-framework-addon-rhel9@sha256:1234567890"
        image: "arohcpsvcdev.azurecr.io/acm-d-cache/acm-governance-policy-addon-controller-rhel9@sha256:1234567890"
        imagePullPolicy: IfNotPresent
        name: manager
        resources:
          requests:
            cpu: 25m
            memory: 64Mi
        securityContext:
          allowPrivilegeEscalation: false
          capabilities:
            drop:
            - ALL
          privileged: false
          readOnlyRootFilesystem: true
          runAsNonRoot: true
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        volumeMounts:
        - mountPath: /tmp
          name: tmp
      dnsPolicy: ClusterFirst
      imagePullSecrets:
      - name: open-cluster-management-image-pull-credentials
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext:
        runAsNonRoot: true
      serviceAccount: grc-policy-addon-sa
      serviceAccountName: grc-policy-addon-sa
      terminationGracePeriodSeconds: 10
      tolerations:
      - effect: NoSchedule
        key: node-role.kubernetes.io/infra
        operator: Exists
      volumes:
      - emptyDir: {}
        name: tmp
---
# Source: multicluster-engine-local-cluster/charts/policy/charts/grc/templates/grc-policy-propagator.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    app: grc
    component: ocm-policy-propagator
  name: grc-policy-propagator
  namespace: 'multicluster-engine'
spec:
  progressDeadlineSeconds: 600
  replicas: 2
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      app: grc
      component: ocm-policy-propagator
  strategy:
    rollingUpdate:
      maxSurge: 25%
      maxUnavailable: 25%
    type: RollingUpdate
  template:
    metadata:
      annotations:
        kubectl.kubernetes.io/default-container: governance-policy-propagator
      creationTimestamp: null
      labels:
        app: grc
        component: ocm-policy-propagator
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: kubernetes.io/arch
                operator: In
                values:
                - amd64
                - ppc64le
                - s390x
                - arm64
        podAntiAffinity:
          preferredDuringSchedulingIgnoredDuringExecution:
          - podAffinityTerm:
              labelSelector:
                matchExpressions:
                - key: ocm-antiaffinity-selector
                  operator: In
                  values:
                  - grcpolicypropagator
              topologyKey: topology.kubernetes.io/zone
            weight: 70
          - podAffinityTerm:
              labelSelector:
                matchExpressions:
                - key: ocm-antiaffinity-selector
                  operator: In
                  values:
                  - grcpolicypropagator
              topologyKey: kubernetes.io/hostname
            weight: 35
      containers:
      - args:
        - --health-probe-bind-address=:8081
        - --metrics-bind-address=0.0.0.0:8383
        - --enable-webhooks=false
        command:
        - governance-policy-propagator
        env:
        - name: WATCH_NAMESPACE
          value: ""
        - name: WATCH_NAMESPACE_COMPLIANCE_EVENTS_STORE
          valueFrom:
            fieldRef:
              fieldPath: metadata.namespace
        - name: POD_NAME
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: metadata.name
        - name: OPERATOR_NAME
          value: governance-policy-propagator
        image: "arohcpsvcdev.azurecr.io/acm-d-cache/governance-policy-propagator-rhel9@sha256:1234567890"
        imagePullPolicy: IfNotPresent
        livenessProbe:
          exec:
            command:
            - ls
          failureThreshold: 3
          initialDelaySeconds: 15
          periodSeconds: 15
          successThreshold: 1
          timeoutSeconds: 1
        name: governance-policy-propagator
        ports:
        - containerPort: 9443
          name: webhook-http
          protocol: TCP
        readinessProbe:
          exec:
            command:
            - ls
          failureThreshold: 3
          initialDelaySeconds: 15
          periodSeconds: 15
          successThreshold: 1
          timeoutSeconds: 1
        resources:
          requests:
            cpu: 25m
            memory: 64Mi
        securityContext:
          allowPrivilegeEscalation: false
          capabilities:
            drop:
            - ALL
          privileged: false
          readOnlyRootFilesystem: true
          runAsNonRoot: true
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        volumeMounts:
        - mountPath: /tmp
          name: tmp
      dnsPolicy: ClusterFirst
      imagePullSecrets:
      - name: open-cluster-management-image-pull-credentials
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext:
        runAsNonRoot: true
      serviceAccount: grc-sa
      serviceAccountName: grc-sa
      terminationGracePeriodSeconds: 30
      tolerations:
      - effect: NoSchedule
        key: node-role.kubernetes.io/infra
        operator: Exists
      volumes:
      - emptyDir: {}
        name: tmp
---
# Source: multicluster-engine-local-cluster/templates/addon-hosted-config.addondeployconfig.yaml
apiVersion: addon.open-cluster-management.io/v1alpha1
kind: AddOnDeploymentConfig
metadata:
  name: addon-hosted-config
  namespace: multicluster-engine
spec:
  customizedVariables:
  - name: managedKubeConfigSecret
    value: external-managed-kubeconfig
---
# Source: multicluster-engine-local-cluster/charts/policy/charts/grc/templates/config-policy-clustermanagementaddon.yaml
apiVersion: addon.open-cluster-management.io/v1alpha1
kind: ClusterManagementAddOn
metadata:
  name: config-policy-controller
spec:
  addOnMeta:
    description: Audits k8s resources and remediates violation based on configuration policies.
    displayName: Config Policy Addon
  supportedConfigs:
    - group: addon.open-cluster-management.io
      resource: addondeploymentconfigs
      defaultConfig:
        name: addon-hosted-config
        namespace: multicluster-engine
---
# Source: multicluster-engine-local-cluster/charts/policy/charts/grc/templates/governance-policy-framework-clustermanagementaddon.yaml
apiVersion: addon.open-cluster-management.io/v1alpha1
kind: ClusterManagementAddOn
metadata:
  name: governance-policy-framework
spec:
  addOnMeta:
    description: Distributes policies and collects policy evaluation results.
    displayName: Governance Policy Framework Addon
  supportedConfigs:
    - group: addon.open-cluster-management.io
      resource: addondeploymentconfigs
      defaultConfig:
        name: addon-hosted-config
        namespace: multicluster-engine
---
# Source: multicluster-engine-local-cluster/templates/local-cluster.klusterletaddonconfig.yaml
apiVersion: agent.open-cluster-management.io/v1
kind: KlusterletAddonConfig
metadata:
  name: local-cluster
  namespace: local-cluster
spec:
  applicationManager:
    enabled: false
  certPolicyController:
    enabled: false
  policyController:
    enabled: true
  searchCollector:
    enabled: false
---
# Source: multicluster-engine-local-cluster/templates/global.klusterletconfig.yaml
apiVersion: config.open-cluster-management.io/v1alpha1
kind: KlusterletConfig
metadata:
  name: global
spec:
  hubKubeAPIServerURL: "https://kubernetes.default.svc"
---
# Source: multicluster-engine-local-cluster/templates/hypershift-management-clusters.managedclusterset.yaml
apiVersion: cluster.open-cluster-management.io/v1beta2
kind: ManagedClusterSet
metadata:
  name: hypershift-management-clusters

---
# Source: multicluster-engine-local-cluster/templates/finalize.job.yaml
apiVersion: batch/v1
kind: Job
metadata:
  name: finalize-mce-config
  namespace: 'multicluster-engine'
  annotations:
    "helm.sh/hook": post-install,post-upgrade
    "helm.sh/hook-weight": "1"
    "helm.sh/hook-delete-policy": before-hook-creation,hook-succeeded,hook-failed
spec:
  activeDeadlineSeconds: 1800
  backoffLimit: 3
  template:
    spec:
      containers:
      - command:
        - /bin/sh
        - -c
        - |
          echo "Waiting for AddonDeploymentConfig 'hypershift-addon-deploy-config' to exist..."
          until kubectl get AddonDeploymentConfig hypershift-addon-deploy-config; do
            sleep 5
          done

          echo "AddonDeploymentConfig 'hypershift-addon-deploy-config' found. Patching..."
          kubectl patch addondeploymentconfig hypershift-addon-deploy-config -n multicluster-engine --type=merge -p '{"spec":{"customizedVariables":[{"name":"disableMetrics","value": "true"},{"name":"disableHOManagement","value": "true"},{"name":"autoImportDisabled","value": "true"},{"name":"aroHcp","value": "true"}]}}'
          echo "Patch applied successfully."

          echo "Wait for MulticlusterEngine to be available..."
          timeout=600
          interval=5
          elapsed=0
          while true; do
            phase=$(kubectl get mce multiclusterengine -o jsonpath='{.status.phase}')
            if [ "$phase" = "Available" ] || [ "$phase" = "Paused" ]; then
              break
            fi
            if [ $elapsed -ge $timeout ]; then
              break
            fi
            sleep $interval
            elapsed=$((elapsed + interval))
          done
          if [ $? -ne 0 ]; then
            echo "MulticlusterEngine did not become available within the timeout period."
            exit 1
          fi
          echo "MulticlusterEngine is available"
        image: "mcr.microsoft.com/aks/command/runtime@sha256:1234567890"
        name: finalize
      restartPolicy: Never
      serviceAccountName: multicluster-engine-operator
